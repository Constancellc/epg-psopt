# packagesimport csvimport randomimport copyimport matplotlib.pyplot as pltimport numpy as npimport sysimport win32com.clienta = 1.1532b = 2.0982outfile = 'riskDayLoadsInAndOut.csv'loads = 'riskDaySpecifiedVsAppliedLoaad.csv'checkLoads = Falseengine = win32com.client.Dispatch("OpenDSSEngine.DSS")engine.Start("0")results = []appl = np.zeros((14400,110))spec = []c = 0for mc in range(0,10):    for i in range(1,56):                with open('household-profiles/'+str(i)+'.csv','w') as csvfile:            writer = csv.writer(csvfile)            for j in range(0,1440):                ran = np.random.gamma(a,scale=1/b)                writer.writerow([ran])                if checkLoads == True:                    spec.append(ran)    engine.text.Command='clear'    circuit = engine.ActiveCircuit    engine.text.Command='compile master.dss'    engine.Text.Command='Export mon LINE1_PQ_vs_Time'        with open('LVTest_Mon_line1_pq_vs_time.csv','rU') as csvfile:        reader = csv.reader(csvfile)        next(reader)        for row in reader:            results.append([-float(row[2])-float(row[4])-float(row[6]),                            -float(row[3])-float(row[5])-float(row[7])])    for hh in range(1,56):        engine.Text.Command='Export mon hh'+str(hh)+'_pQ_vs_time'        with open('LVTest_Mon_hh'+str(hh)+'_pq_vs_time.csv','rU') as csvfile:            reader = csv.reader(csvfile)            next(reader)            t = 0            for row in reader:                appl[int(mc*1440+t)][int(2*(hh-1))] = float(row[2])                appl[int(mc*1440+t)][int(2*(hh-1)+1)] = float(row[3])                t += 1##                appl.append([float(row[2]),float(row[3])])lds = []for i in range(1,56):    lds.append('P_'+str(i))    lds.append('Q_'+str(i))    with open(outfile,'w') as csvfile:    writer = csv.writer(csvfile)    writer.writerow(['P_in','Q_in']+lds)    for i in range(len(results)):        row = []        for cell in results[i]:            row.append(cell)        for cell in appl[i]:            row.append(cell)        '''        for j in range(55):            row += appl[int(55*i+j)]        '''        writer.writerow(row)if checkLoads == True:    with open(loads,'w') as csvfile:        writer = csv.writer(csvfile)        writer.writerow(['Specified Load','Applied Load'])        for i in range(len(spec)):            writer.writerow([spec[i],appl[i][0]])